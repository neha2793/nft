(function(i,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(i=typeof globalThis<"u"?globalThis:i||self,o(i["ethers-error-parser"]={}))})(this,function(i){"use strict";const o={TRANSACTION_RAN_OUT_OF_GAS:"TRANSACTION_RAN_OUT_OF_GAS",TRANSACTION_UNDERPRICED:"TRANSACTION_UNDERPRICED",REJECTED_TRANSACTION:"REJECTED_TRANSACTION",CALL_REVERTED:"CALL_REVERTED",EXECUTION_REVERTED:"EXECUTION_REVERTED",NONCE_TOO_LOW:"NONCE_TOO_LOW",INSUFFICIENT_FUNDS_FOR_GAS:"INSUFFICIENT_FUNDS_FOR_GAS",MAX_PRIORITY_FEE_PER_GAS_HIGHER_THAN_MAX_FEE_PER_GAS:"MAX_PRIORITY_FEE_PER_GAS_HIGHER_THAN_MAX_FEE_PER_GAS",MAX_FEE_PER_GAS_LESS_THAN_BLOCK_BASE_FEE:"MAX_FEE_PER_GAS_LESS_THAN_BLOCK_BASE_FEE",UNKNOWN_ERROR:"UNKNOWN_ERROR"},R={NONCE_EXPIRED:"NONCE_EXPIRED",UNPREDICTABLE_GAS_LIMIT:"UNPREDICTABLE_GAS_LIMIT",ACTION_REJECTED:"ACTION_REJECTED",CALL_EXCEPTION:"CALL_EXCEPTION"},n={REJECTED_TRANSACTION:4001,REQUIRE_TRANSACTION:-32603,ERROR_WHILE_FORMATTING_OUTPUT_FROM_RPC:-32603,TRANSACTION_UNDERPRICED:-32e3};function d(e,r){var t;if(e!==n.ERROR_WHILE_FORMATTING_OUTPUT_FROM_RPC)return;const E=(t=r.split("RPC '")[1])==null?void 0:t.slice(0,-1);if(E!==void 0)try{const _=JSON.parse(E);if(_.value===void 0||_.value.data===void 0)return;if(_.value.data.code===n.TRANSACTION_UNDERPRICED)return{errorCode:o.TRANSACTION_UNDERPRICED,context:void 0}}catch{return}}function N(e){const r=e.code,E=e.message;if(r!==void 0){if(E!==void 0){const t=d(r,E);if(t!==void 0)return t}if(r===n.REJECTED_TRANSACTION)return{errorCode:o.REJECTED_TRANSACTION,context:E};if(r===n.REQUIRE_TRANSACTION&&E!==void 0&&E.includes("execution reverted: "))return{errorCode:o.EXECUTION_REVERTED,context:E.slice(20)}}}function T(e){if(e.code===R.UNPREDICTABLE_GAS_LIMIT){if(e.error!==void 0&&e.error.code===n.REQUIRE_TRANSACTION&&e.error.data!==void 0&&e.error.data.message!==void 0){const r=e.error.data.message;if(r.includes("execution reverted: "))return{errorCode:o.EXECUTION_REVERTED,context:r.slice(20)}}if(e.error!==void 0&&e.error.error!==void 0&&e.error.error.error!==void 0&&e.error.error.error.code===n.TRANSACTION_UNDERPRICED&&e.error.error.body!==void 0)try{const r=JSON.parse(e.error.error.body);if(r.error!==void 0&&r.error.message!==void 0){if(r.error.message.includes("gas required exceeds allowance (0)"))return{errorCode:o.INSUFFICIENT_FUNDS_FOR_GAS,context:void 0};if(r.error.message.includes("max priority fee per gas higher than max fee per gas"))return{errorCode:o.MAX_PRIORITY_FEE_PER_GAS_HIGHER_THAN_MAX_FEE_PER_GAS,context:void 0};if(r.error.message.includes("max fee per gas less than block base fee"))return{errorCode:o.MAX_FEE_PER_GAS_LESS_THAN_BLOCK_BASE_FEE,context:void 0}}}catch{return}}}function A(e){if(e.code===R.NONCE_EXPIRED&&e.transaction!==void 0)return{errorCode:o.NONCE_TOO_LOW,context:e.transaction.nonce.toString()};if(e.code===R.ACTION_REJECTED&&e.action==="sendTransaction")return{errorCode:o.REJECTED_TRANSACTION,context:e.message};if(e.code===R.CALL_EXCEPTION&&e.reason!==void 0)return{errorCode:o.CALL_REVERTED,context:e.reason};const r=T(e);if(r!==void 0)return r}function C(e){const r=e,E=e.error,t=A(r);if(t!==void 0)return t;if(E!==void 0){const _=N(E);if(_!==void 0)return _}if(r.transaction!==void 0&&r.receipt!==void 0){const _=r.transaction.gasLimit;if(r.receipt.gasUsed.gte(_))return{errorCode:o.TRANSACTION_RAN_OUT_OF_GAS,context:r.transaction.gasLimit.toString()}}return e.error!==void 0&&e.error.message!==void 0?{errorCode:o.UNKNOWN_ERROR,context:e.error.message}:r.code!==void 0?{errorCode:o.UNKNOWN_ERROR,context:r.code.toString()}:{errorCode:o.UNKNOWN_ERROR,context:void 0}}i.RETURN_VALUE_ERROR_CODES=o,i.getParsedEthersError=C,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
